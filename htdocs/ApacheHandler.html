<HTML>
<HEAD>
<TITLE>HTML::Mason::ApacheHandler - Mason/mod_perl interface</TITLE>
<LINK REV="made" HREF="mailto:perl@packages.debian.org">
</HEAD>

<BODY>

<A NAME="__index__"></A>
<!-- INDEX BEGIN -->

<UL>

	<LI><A HREF="#name">NAME</A></LI>
	<LI><A HREF="#synopsis">SYNOPSIS</A></LI>
	<LI><A HREF="#description">DESCRIPTION</A></LI>
	<LI><A HREF="#parameters to the new() contructor">PARAMETERS TO THE <CODE>new()</CODE> CONTRUCTOR</A></LI>
	<LI><A HREF="#accessor methods">ACCESSOR METHODS</A></LI>
	<LI><A HREF="#other methods">OTHER METHODS</A></LI>
	<LI><A HREF="#see also">SEE ALSO</A></LI>
</UL>
<!-- INDEX END -->

<HR>
<P>
<H1><A NAME="name">NAME</A></H1>
<P>HTML::Mason::ApacheHandler - Mason/mod_perl interface</P>
<P>
<HR>
<H1><A NAME="synopsis">SYNOPSIS</A></H1>
<PRE>
    use HTML::Mason::ApacheHandler;</PRE>
<PRE>
    my $ah = new HTML::Mason::ApacheHandler (..name/value params..);
    ...
    sub handler {
        my $r = shift;
        $ah-&gt;handle_request($r);
    }</PRE>
<P>
<HR>
<H1><A NAME="description">DESCRIPTION</A></H1>
<P>The ApacheHandler object links Mason to mod_perl, running components in
response to HTTP requests. It is controlled primarily through
parameters to the <CODE>new()</CODE> constructor.</P>
<P><A HREF="#item_handle_request"><CODE>handle_request()</CODE></A> is not a user method, but rather is called from the
HTML::Mason::handler() routine in handler.pl.</P>
<P>
<HR>
<H1><A NAME="parameters to the new() contructor">PARAMETERS TO THE <CODE>new()</CODE> CONTRUCTOR</A></H1>
<DL>
<DT><STRONG><A NAME="item_apache_status_title">apache_status_title</A></STRONG><BR>
<DD>
Title that you want this ApacheHandler to appear as under
Apache::Status.  Default is ``HTML::Mason status''.  This is useful if
you create more than one ApacheHandler object and want them all
visible via Apache::Status.
<P></P>
<DT><STRONG><A NAME="item_args_method">args_method</A></STRONG><BR>
<DD>
Method to use for unpacking GET and POST arguments. The valid options
are 'CGI' and 'mod_perl'; these indicate that a CGI.pm or
Apache::Request object (respectively) will be created for the purposes
of argument handling.
<P>Apache::Request is the default and requires that you have installed
this package.</P>
<P>If the args_method is 'CGI', the Mason request object ($m) will have a
method called <CODE>cgi_object</CODE> available.  This method returns the CGI
object used in the ApacheHandler code.</P>
<P>If args_method is 'mod_perl', the $r global is upgraded to an
Apache::Request object. This object inherits all Apache methods and
adds a few of its own, dealing with parameters and file uploads.  See
<A HREF="/Apache/Request.html">Apache::Request</A> for more information.</P>
<P>While Mason will load Apache::Request or CGI as needed at runtime, it
is recommended that you preload the relevant module either in your
httpd.conf or handler.pl file, as this will save some memory.</P>
<P></P>
<DT><STRONG><A NAME="item_decline_dirs">decline_dirs</A></STRONG><BR>
<DD>
Indicates whether Mason should decline directory requests, leaving
Apache to serve up a directory index or a FORBIDDEN error as
appropriate. Default is 1. See <A HREF="Admin.html#allowing directory requests">Allowing directory requests in the Admin manual</A> for
more information about handling directories with Mason.
<P></P>
<DT><STRONG><A NAME="item_interp">interp</A></STRONG><BR>
<DD>
Specifies a Mason interpreter to use for handling requests.  An
<CODE>HTML::Mason::Interp</CODE> object will be created if you don't specify one
yourself.  The interpreter should be an instance of the
<CODE>HTML::Mason::Interp</CODE> class, or a subclass thereof.
<P></P></DL>
<P>
<HR>
<H1><A NAME="accessor methods">ACCESSOR METHODS</A></H1>
<P>All of the above properties, except interp, have standard accessor
methods of the same name: no arguments retrieves the value, and one
argument sets it, except for args_method, which is not settable.  For
example:</P>
<PRE>
    my $ah = new HTML::Mason::ApacheHandler;
    my $decline_dirs = $ah-&gt;decline_dirs;
    $ah-&gt;decline_dirs(1);</PRE>
<P>
<HR>
<H1><A NAME="other methods">OTHER METHODS</A></H1>
<P>The ApacheHandler object has a few other publically accessible methods
that may be of interest to end users.</P>
<DL>
<DT><STRONG><A NAME="item_handle_request">handle_request ($r)</A></STRONG><BR>
<DD>
This method takes an Apache object representing a request and
translates that request into a form Mason can understand.  It's return
value is an Apache status code.
<P></P>
<DT><STRONG><A NAME="item_prepare_request">prepare_request ($r)</A></STRONG><BR>
<DD>
This method takes an Apache object representing a request and returns
a new Mason request object or an Apache status code.  If it is a
request object you can manipulate that object as you like, and then
call the request object's <CODE>exec</CODE> method to have it generate output.
<P>If this method returns an Apache status code, that means that it could
not create a Mason request object.</P>
<P>This method is useful if you would like to have a chance to decline a
request based on properties of the Mason request object or a component
object.  For example:</P>
<PRE>
    my $req = $ah-&gt;prepare_request($r);
    # $req must be an Apache status code if it's not an object
    return $req unless ref($req);</PRE>
<PRE>
    return DECLINED
        unless $req-&gt;request_comp-&gt;source_file =~ /\.html$/;</PRE>
<PRE>
    $req-&gt;exec;</PRE>
<P></P>
<DT><STRONG><A NAME="item_request_args">request_args ($r)</A></STRONG><BR>
<DD>
Given an Apache request object, this method returns a three item list.
The first item is a hash reference containing the arguments passed by
the client's request.
<P>The second is an Apache request object, possibly the one originally
passed to the method.</P>
<P>The third item may be a CGI.pm object or <CODE>undef</CODE>, depending on the
value of the ``args_method'' parameter for the ApacheHandler object.</P>
<P></P></DL>
<P>
<HR>
<H1><A NAME="see also">SEE ALSO</A></H1>
<P><A HREF="Mason.html">HTML::Mason</A>,
<A HREF="Admin.html">HTML::Mason::Admin</A>,
<A HREF="Interp.html">HTML::Mason::Interp</A></P>

</BODY>

</HTML>
